{"uid":"a00391c64319c260","name":"test_upgrade_from_edge","fullName":"tests.integration.test_upgrade#test_upgrade_from_edge","historyId":"59e96b2cf75bb30d0a5cbde0e5234d56","time":{"start":1720145419439,"stop":1720145746006,"duration":326567},"description":"Upgrade mysqlrouter while ensuring continuous writes incrementing.","descriptionHtml":"<p>Upgrade mysqlrouter while ensuring continuous writes incrementing.</p>\n","status":"failed","statusMessage":"AssertionError: None of the units are upgraded\nassert '+testupgrade' in 'Model  Controller          Cloud/Region        Version  SLA          Timestamp\\ntest   microk8s-localhost  microk8s/localhost  3.4.3    unsupported  02:15:45Z\\n\\nApp               Version                  Status   Scale  Charm             Channel      Rev  Address         Exposed  Message\\nmysql-k8s         8.0.37-0ubuntu0.22.04.3  active       1  mysql-k8s         8.0/edge     158  10.152.183.78   no       \\nmysql-router-k8s  8.0.37-0ubuntu0.22.04.3  waiting      3  mysql-router-k8s  8.0/edge       0  10.152.183.66   no       installing agent\\nmysql-test-app    0.0.2                    active       1  mysql-test-app    latest/edge   46  10.152.183.201  no       \\n\\nUnit                 Workload  Agent  Address      Ports  Message\\nmysql-k8s/0*         active    idle   10.1.136.77         Primary\\nmysql-router-k8s/0   active    idle   10.1.136.73         Router 8.0.37 running (restart pending); Charmed operator 1.2+ee5d2ff\\nmysql-router-k8s/1*  active    idle   10.1.136.74         Router 8.0.37 running (restart pending); Charmed operator 1.2+ee5d2ff\\nmysql-router-k8s/2   blocked   idle   10.1.136.78         Upgrade incompatible. Rollback to previous revision with `juju refresh`\\nmysql-test-app/0*    active    idle   10.1.136.72         \\n'\n +  where 'Model  Controller          Cloud/Region        Version  SLA          Timestamp\\ntest   microk8s-localhost  microk8s/localhost  3.4.3    unsupported  02:15:45Z\\n\\nApp               Version                  Status   Scale  Charm             Channel      Rev  Address         Exposed  Message\\nmysql-k8s         8.0.37-0ubuntu0.22.04.3  active       1  mysql-k8s         8.0/edge     158  10.152.183.78   no       \\nmysql-router-k8s  8.0.37-0ubuntu0.22.04.3  waiting      3  mysql-router-k8s  8.0/edge       0  10.152.183.66   no       installing agent\\nmysql-test-app    0.0.2                    active       1  mysql-test-app    latest/edge   46  10.152.183.201  no       \\n\\nUnit                 Workload  Agent  Address      Ports  Message\\nmysql-k8s/0*         active    idle   10.1.136.77         Primary\\nmysql-router-k8s/0   active    idle   10.1.136.73         Router 8.0.37 running (restart pending); Charmed operator 1.2+ee5d2ff\\nmysql-router-k8s/1*  active    idle   10.1.136.74         Router 8.0.37 running (restart pending); Charmed operator 1.2+ee5d2ff\\nmysql-router-k8s/2   blocked   idle   10.1.136.78         Upgrade incompatible. Rollback to previous revision with `juju refresh`\\nmysql-test-app/0*    active    idle   10.1.136.72         \\n' = get_juju_status('test')\n +    where 'test' = <juju.model.Model object at 0x7f68c07a0e80>.name\n +      where <juju.model.Model object at 0x7f68c07a0e80> = <pytest_operator.plugin.OpsTest object at 0x7f68c4bc53f0>.model","statusTrace":"Traceback (most recent call last):\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 341, in from_call\n    result: Optional[TResult] = func()\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_hooks.py\", line 493, in __call__\n    return self._hookexec(self.name, self._hookimpls, kwargs, firstresult)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_manager.py\", line 115, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 152, in _multicall\n    return outcome.get_result()\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_result.py\", line 114, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 77, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    raise e\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    item.runtest()\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/python.py\", line 1788, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_hooks.py\", line 493, in __call__\n    return self._hookexec(self.name, self._hookimpls, kwargs, firstresult)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_manager.py\", line 115, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 152, in _multicall\n    return outcome.get_result()\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_result.py\", line 114, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 77, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pytest_asyncio/plugin.py\", line 532, in inner\n    _loop.run_until_complete(task)\n  File \"/usr/lib/python3.10/asyncio/base_events.py\", line 649, in run_until_complete\n    return future.result()\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/tests/integration/test_upgrade.py\", line 125, in test_upgrade_from_edge\n    for attempt in tenacity.Retrying(\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/tenacity/__init__.py\", line 347, in __iter__\n    do = self.iter(retry_state=retry_state)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/tenacity/__init__.py\", line 325, in iter\n    raise retry_exc.reraise()\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/tenacity/__init__.py\", line 158, in reraise\n    raise self.last_attempt.result()\n  File \"/usr/lib/python3.10/concurrent/futures/_base.py\", line 451, in result\n    return self.__get_result()\n  File \"/usr/lib/python3.10/concurrent/futures/_base.py\", line 403, in __get_result\n    raise self._exception\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/tests/integration/test_upgrade.py\", line 131, in test_upgrade_from_edge\n    assert \"+testupgrade\" in get_juju_status(\nAssertionError: None of the units are upgraded\nassert '+testupgrade' in 'Model  Controller          Cloud/Region        Version  SLA          Timestamp\\ntest   microk8s-localhost  microk8s/localhost  3.4.3    unsupported  02:15:45Z\\n\\nApp               Version                  Status   Scale  Charm             Channel      Rev  Address         Exposed  Message\\nmysql-k8s         8.0.37-0ubuntu0.22.04.3  active       1  mysql-k8s         8.0/edge     158  10.152.183.78   no       \\nmysql-router-k8s  8.0.37-0ubuntu0.22.04.3  waiting      3  mysql-router-k8s  8.0/edge       0  10.152.183.66   no       installing agent\\nmysql-test-app    0.0.2                    active       1  mysql-test-app    latest/edge   46  10.152.183.201  no       \\n\\nUnit                 Workload  Agent  Address      Ports  Message\\nmysql-k8s/0*         active    idle   10.1.136.77         Primary\\nmysql-router-k8s/0   active    idle   10.1.136.73         Router 8.0.37 running (restart pending); Charmed operator 1.2+ee5d2ff\\nmysql-router-k8s/1*  active    idle   10.1.136.74         Router 8.0.37 running (restart pending); Charmed operator 1.2+ee5d2ff\\nmysql-router-k8s/2   blocked   idle   10.1.136.78         Upgrade incompatible. Rollback to previous revision with `juju refresh`\\nmysql-test-app/0*    active    idle   10.1.136.72         \\n'\n +  where 'Model  Controller          Cloud/Region        Version  SLA          Timestamp\\ntest   microk8s-localhost  microk8s/localhost  3.4.3    unsupported  02:15:45Z\\n\\nApp               Version                  Status   Scale  Charm             Channel      Rev  Address         Exposed  Message\\nmysql-k8s         8.0.37-0ubuntu0.22.04.3  active       1  mysql-k8s         8.0/edge     158  10.152.183.78   no       \\nmysql-router-k8s  8.0.37-0ubuntu0.22.04.3  waiting      3  mysql-router-k8s  8.0/edge       0  10.152.183.66   no       installing agent\\nmysql-test-app    0.0.2                    active       1  mysql-test-app    latest/edge   46  10.152.183.201  no       \\n\\nUnit                 Workload  Agent  Address      Ports  Message\\nmysql-k8s/0*         active    idle   10.1.136.77         Primary\\nmysql-router-k8s/0   active    idle   10.1.136.73         Router 8.0.37 running (restart pending); Charmed operator 1.2+ee5d2ff\\nmysql-router-k8s/1*  active    idle   10.1.136.74         Router 8.0.37 running (restart pending); Charmed operator 1.2+ee5d2ff\\nmysql-router-k8s/2   blocked   idle   10.1.136.78         Upgrade incompatible. Rollback to previous revision with `juju refresh`\\nmysql-test-app/0*    active    idle   10.1.136.72         \\n' = get_juju_status('test')\n +    where 'test' = <juju.model.Model object at 0x7f68c07a0e80>.name\n +      where <juju.model.Model object at 0x7f68c07a0e80> = <pytest_operator.plugin.OpsTest object at 0x7f68c4bc53f0>.model","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":1,"retriesStatusChange":true,"beforeStages":[{"name":"event_loop","time":{"start":1720145302061,"stop":1720145302062,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"ops_test","time":{"start":1720145302062,"stop":1720145302319,"duration":257},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tmp_path_factory","time":{"start":1720145302062,"stop":1720145302062,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail","time":{"start":1720145419439,"stop":1720145419439,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Upgrade mysqlrouter while ensuring continuous writes incrementing.","status":"failed","statusMessage":"AssertionError: None of the units are upgraded\nassert '+testupgrade' in 'Model  Controller          Cloud/Region        Version  SLA          Timestamp\\ntest   microk8s-localhost  microk8s/localhost  3.4.3    unsupported  02:15:45Z\\n\\nApp               Version                  Status   Scale  Charm             Channel      Rev  Address         Exposed  Message\\nmysql-k8s         8.0.37-0ubuntu0.22.04.3  active       1  mysql-k8s         8.0/edge     158  10.152.183.78   no       \\nmysql-router-k8s  8.0.37-0ubuntu0.22.04.3  waiting      3  mysql-router-k8s  8.0/edge       0  10.152.183.66   no       installing agent\\nmysql-test-app    0.0.2                    active       1  mysql-test-app    latest/edge   46  10.152.183.201  no       \\n\\nUnit                 Workload  Agent  Address      Ports  Message\\nmysql-k8s/0*         active    idle   10.1.136.77         Primary\\nmysql-router-k8s/0   active    idle   10.1.136.73         Router 8.0.37 running (restart pending); Charmed operator 1.2+ee5d2ff\\nmysql-router-k8s/1*  active    idle   10.1.136.74         Router 8.0.37 running (restart pending); Charmed operator 1.2+ee5d2ff\\nmysql-router-k8s/2   blocked   idle   10.1.136.78         Upgrade incompatible. Rollback to previous revision with `juju refresh`\\nmysql-test-app/0*    active    idle   10.1.136.72         \\n'\n +  where 'Model  Controller          Cloud/Region        Version  SLA          Timestamp\\ntest   microk8s-localhost  microk8s/localhost  3.4.3    unsupported  02:15:45Z\\n\\nApp               Version                  Status   Scale  Charm             Channel      Rev  Address         Exposed  Message\\nmysql-k8s         8.0.37-0ubuntu0.22.04.3  active       1  mysql-k8s         8.0/edge     158  10.152.183.78   no       \\nmysql-router-k8s  8.0.37-0ubuntu0.22.04.3  waiting      3  mysql-router-k8s  8.0/edge       0  10.152.183.66   no       installing agent\\nmysql-test-app    0.0.2                    active       1  mysql-test-app    latest/edge   46  10.152.183.201  no       \\n\\nUnit                 Workload  Agent  Address      Ports  Message\\nmysql-k8s/0*         active    idle   10.1.136.77         Primary\\nmysql-router-k8s/0   active    idle   10.1.136.73         Router 8.0.37 running (restart pending); Charmed operator 1.2+ee5d2ff\\nmysql-router-k8s/1*  active    idle   10.1.136.74         Router 8.0.37 running (restart pending); Charmed operator 1.2+ee5d2ff\\nmysql-router-k8s/2   blocked   idle   10.1.136.78         Upgrade incompatible. Rollback to previous revision with `juju refresh`\\nmysql-test-app/0*    active    idle   10.1.136.72         \\n' = get_juju_status('test')\n +    where 'test' = <juju.model.Model object at 0x7f68c07a0e80>.name\n +      where <juju.model.Model object at 0x7f68c07a0e80> = <pytest_operator.plugin.OpsTest object at 0x7f68c4bc53f0>.model","statusTrace":"Traceback (most recent call last):\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 341, in from_call\n    result: Optional[TResult] = func()\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_hooks.py\", line 493, in __call__\n    return self._hookexec(self.name, self._hookimpls, kwargs, firstresult)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_manager.py\", line 115, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 152, in _multicall\n    return outcome.get_result()\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_result.py\", line 114, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 77, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    raise e\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    item.runtest()\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/python.py\", line 1788, in runtest\n    self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_hooks.py\", line 493, in __call__\n    return self._hookexec(self.name, self._hookimpls, kwargs, firstresult)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_manager.py\", line 115, in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 152, in _multicall\n    return outcome.get_result()\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_result.py\", line 114, in get_result\n    raise exc.with_traceback(exc.__traceback__)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pluggy/_callers.py\", line 77, in _multicall\n    res = hook_impl.function(*args)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    result = testfunction(**testargs)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/pytest_asyncio/plugin.py\", line 532, in inner\n    _loop.run_until_complete(task)\n  File \"/usr/lib/python3.10/asyncio/base_events.py\", line 649, in run_until_complete\n    return future.result()\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/tests/integration/test_upgrade.py\", line 125, in test_upgrade_from_edge\n    for attempt in tenacity.Retrying(\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/tenacity/__init__.py\", line 347, in __iter__\n    do = self.iter(retry_state=retry_state)\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/tenacity/__init__.py\", line 325, in iter\n    raise retry_exc.reraise()\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/.tox/integration/lib/python3.10/site-packages/tenacity/__init__.py\", line 158, in reraise\n    raise self.last_attempt.result()\n  File \"/usr/lib/python3.10/concurrent/futures/_base.py\", line 451, in result\n    return self.__get_result()\n  File \"/usr/lib/python3.10/concurrent/futures/_base.py\", line 403, in __get_result\n    raise self._exception\n  File \"/home/runner/work/mysql-router-k8s-operator/mysql-router-k8s-operator/tests/integration/test_upgrade.py\", line 131, in test_upgrade_from_edge\n    assert \"+testupgrade\" in get_juju_status(\nAssertionError: None of the units are upgraded\nassert '+testupgrade' in 'Model  Controller          Cloud/Region        Version  SLA          Timestamp\\ntest   microk8s-localhost  microk8s/localhost  3.4.3    unsupported  02:15:45Z\\n\\nApp               Version                  Status   Scale  Charm             Channel      Rev  Address         Exposed  Message\\nmysql-k8s         8.0.37-0ubuntu0.22.04.3  active       1  mysql-k8s         8.0/edge     158  10.152.183.78   no       \\nmysql-router-k8s  8.0.37-0ubuntu0.22.04.3  waiting      3  mysql-router-k8s  8.0/edge       0  10.152.183.66   no       installing agent\\nmysql-test-app    0.0.2                    active       1  mysql-test-app    latest/edge   46  10.152.183.201  no       \\n\\nUnit                 Workload  Agent  Address      Ports  Message\\nmysql-k8s/0*         active    idle   10.1.136.77         Primary\\nmysql-router-k8s/0   active    idle   10.1.136.73         Router 8.0.37 running (restart pending); Charmed operator 1.2+ee5d2ff\\nmysql-router-k8s/1*  active    idle   10.1.136.74         Router 8.0.37 running (restart pending); Charmed operator 1.2+ee5d2ff\\nmysql-router-k8s/2   blocked   idle   10.1.136.78         Upgrade incompatible. Rollback to previous revision with `juju refresh`\\nmysql-test-app/0*    active    idle   10.1.136.72         \\n'\n +  where 'Model  Controller          Cloud/Region        Version  SLA          Timestamp\\ntest   microk8s-localhost  microk8s/localhost  3.4.3    unsupported  02:15:45Z\\n\\nApp               Version                  Status   Scale  Charm             Channel      Rev  Address         Exposed  Message\\nmysql-k8s         8.0.37-0ubuntu0.22.04.3  active       1  mysql-k8s         8.0/edge     158  10.152.183.78   no       \\nmysql-router-k8s  8.0.37-0ubuntu0.22.04.3  waiting      3  mysql-router-k8s  8.0/edge       0  10.152.183.66   no       installing agent\\nmysql-test-app    0.0.2                    active       1  mysql-test-app    latest/edge   46  10.152.183.201  no       \\n\\nUnit                 Workload  Agent  Address      Ports  Message\\nmysql-k8s/0*         active    idle   10.1.136.77         Primary\\nmysql-router-k8s/0   active    idle   10.1.136.73         Router 8.0.37 running (restart pending); Charmed operator 1.2+ee5d2ff\\nmysql-router-k8s/1*  active    idle   10.1.136.74         Router 8.0.37 running (restart pending); Charmed operator 1.2+ee5d2ff\\nmysql-router-k8s/2   blocked   idle   10.1.136.78         Upgrade incompatible. Rollback to previous revision with `juju refresh`\\nmysql-test-app/0*    active    idle   10.1.136.72         \\n' = get_juju_status('test')\n +    where 'test' = <juju.model.Model object at 0x7f68c07a0e80>.name\n +      where <juju.model.Model object at 0x7f68c07a0e80> = <pytest_operator.plugin.OpsTest object at 0x7f68c4bc53f0>.model","steps":[],"attachments":[{"uid":"dcc3b4d9903fe098","name":"log","source":"dcc3b4d9903fe098.txt","type":"text/plain","size":594}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"abort_on_fail::0","time":{"start":1720145746018,"stop":1720145746018,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"ops_test::finalizer","time":{"start":1720145746022,"stop":1720145766049,"duration":20027},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::2","time":{"start":1720145766050,"stop":1720145766050,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_close_event_loop","time":{"start":1720145766050,"stop":1720145766050,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_provide_clean_event_loop","time":{"start":1720145766050,"stop":1720145766050,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"abort_on_fail"},{"name":"tag","value":"group(1)"},{"name":"tag","value":"asyncio"},{"name":"parentSuite","value":"tests.integration"},{"name":"suite","value":"test_upgrade"},{"name":"host","value":"fv-az566-444"},{"name":"thread","value":"12683-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.test_upgrade"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"8951ced775cc981f","status":"unknown","time":{}}],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":4,"broken":0,"skipped":0,"passed":29,"unknown":5,"total":38},"items":[{"uid":"169caee8c04b1035","reportUrl":"../140//#testresult/169caee8c04b1035","status":"failed","statusDetails":"AssertionError: None of the units are upgraded\nassert '+testupgrade' in 'Model  Controller          Cloud/Region        Version  SLA          Timestamp\\ntest   microk8s-localhost  microk8s/localhost  3.4.3    unsupported  02:15:43Z\\n\\nApp               Version                  Status   Scale  Charm             Channel      Rev  Address         Exposed  Message\\nmysql-k8s         8.0.37-0ubuntu0.22.04.3  active       1  mysql-k8s         8.0/edge     158  10.152.183.162  no       \\nmysql-router-k8s  8.0.37-0ubuntu0.22.04.3  waiting      3  mysql-router-k8s  8.0/edge       0  10.152.183.233  no       installing agent\\nmysql-test-app    0.0.2                    active       1  mysql-test-app    latest/edge   46  10.152.183.82   no       Last written value=24514\\n\\nUnit                 Workload  Agent  Address       Ports  Message\\nmysql-k8s/0*         active    idle   10.1.191.141         Primary\\nmysql-router-k8s/0*  active    idle   10.1.191.136         Router 8.0.37 running (restart pending); Charmed operator 1.2+ee5d2ff\\nmysql-router-k8s/1   active    idle   10.1.191.138         Router 8.0.37 running (restart pending); Charmed operator 1.2+ee5d2ff\\nmysql-router-k8s/2   blocked   idle   10.1.191.142         Upgrade incompatible. Rollback to previous revision with `juju refresh`\\nmysql-test-app/0*    active    idle   10.1.191.139         Last written value=24514\\n'\n +  where 'Model  Controller          Cloud/Region        Version  SLA          Timestamp\\ntest   microk8s-localhost  microk8s/localhost  3.4.3    unsupported  02:15:43Z\\n\\nApp               Version                  Status   Scale  Charm             Channel      Rev  Address         Exposed  Message\\nmysql-k8s         8.0.37-0ubuntu0.22.04.3  active       1  mysql-k8s         8.0/edge     158  10.152.183.162  no       \\nmysql-router-k8s  8.0.37-0ubuntu0.22.04.3  waiting      3  mysql-router-k8s  8.0/edge       0  10.152.183.233  no       installing agent\\nmysql-test-app    0.0.2                    active       1  mysql-test-app    latest/edge   46  10.152.183.82   no       Last written value=24514\\n\\nUnit                 Workload  Agent  Address       Ports  Message\\nmysql-k8s/0*         active    idle   10.1.191.141         Primary\\nmysql-router-k8s/0*  active    idle   10.1.191.136         Router 8.0.37 running (restart pending); Charmed operator 1.2+ee5d2ff\\nmysql-router-k8s/1   active    idle   10.1.191.138         Router 8.0.37 running (restart pending); Charmed operator 1.2+ee5d2ff\\nmysql-router-k8s/2   blocked   idle   10.1.191.142         Upgrade incompatible. Rollback to previous revision with `juju refresh`\\nmysql-test-app/0*    active    idle   10.1.191.139         Last written value=24514\\n' = get_juju_status('test')\n +    where 'test' = <juju.model.Model object at 0x7f881e13d750>.name\n +      where <juju.model.Model object at 0x7f881e13d750> = <pytest_operator.plugin.OpsTest object at 0x7f8819baba90>.model","time":{"start":1720059017537,"stop":1720059343368,"duration":325831}},{"uid":"976eedf1a6280311","reportUrl":"../139//#testresult/976eedf1a6280311","status":"failed","statusDetails":"AssertionError: None of the units are upgraded\nassert '+testupgrade' in 'Model  Controller          Cloud/Region        Version  SLA          Timestamp\\ntest   microk8s-localhost  microk8s/localhost  3.4.3    unsupported  02:16:11Z\\n\\nApp               Version                  Status   Scale  Charm             Channel      Rev  Address         Exposed  Message\\nmysql-k8s         8.0.37-0ubuntu0.22.04.3  active       1  mysql-k8s         8.0/edge     154  10.152.183.18   no       \\nmysql-router-k8s  8.0.37-0ubuntu0.22.04.3  waiting      3  mysql-router-k8s  8.0/edge       0  10.152.183.209  no       waiting for units to settle down\\nmysql-test-app    0.0.2                    active       1  mysql-test-app    latest/edge   46  10.152.183.70   no       \\n\\nUnit                 Workload  Agent  Address      Ports  Message\\nmysql-k8s/0*         active    idle   10.1.23.141         Primary\\nmysql-router-k8s/0   active    idle   10.1.23.138         Router 8.0.37 running (restart pending); Charmed operator 1.2+156da2d\\nmysql-router-k8s/1   active    idle   10.1.23.140         Router 8.0.37 running (restart pending); Charmed operator 1.2+156da2d\\nmysql-router-k8s/2*  blocked   idle   10.1.23.142         Upgrade incompatible. Rollback to previous revision with `juju refresh`\\nmysql-test-app/0*    active    idle   10.1.23.136         \\n'\n +  where 'Model  Controller          Cloud/Region        Version  SLA          Timestamp\\ntest   microk8s-localhost  microk8s/localhost  3.4.3    unsupported  02:16:11Z\\n\\nApp               Version                  Status   Scale  Charm             Channel      Rev  Address         Exposed  Message\\nmysql-k8s         8.0.37-0ubuntu0.22.04.3  active       1  mysql-k8s         8.0/edge     154  10.152.183.18   no       \\nmysql-router-k8s  8.0.37-0ubuntu0.22.04.3  waiting      3  mysql-router-k8s  8.0/edge       0  10.152.183.209  no       waiting for units to settle down\\nmysql-test-app    0.0.2                    active       1  mysql-test-app    latest/edge   46  10.152.183.70   no       \\n\\nUnit                 Workload  Agent  Address      Ports  Message\\nmysql-k8s/0*         active    idle   10.1.23.141         Primary\\nmysql-router-k8s/0   active    idle   10.1.23.138         Router 8.0.37 running (restart pending); Charmed operator 1.2+156da2d\\nmysql-router-k8s/1   active    idle   10.1.23.140         Router 8.0.37 running (restart pending); Charmed operator 1.2+156da2d\\nmysql-router-k8s/2*  blocked   idle   10.1.23.142         Upgrade incompatible. Rollback to previous revision with `juju refresh`\\nmysql-test-app/0*    active    idle   10.1.23.136         \\n' = get_juju_status('test')\n +    where 'test' = <juju.model.Model object at 0x7f0334367220>.name\n +      where <juju.model.Model object at 0x7f0334367220> = <pytest_operator.plugin.OpsTest object at 0x7f0333a7cbe0>.model","time":{"start":1719972626219,"stop":1719972971655,"duration":345436}},{"uid":"dce363bed80a5ff4","reportUrl":"../137//#testresult/dce363bed80a5ff4","status":"failed","statusDetails":"AssertionError: None of the units are upgraded\nassert '+testupgrade' in 'Model  Controller          Cloud/Region        Version  SLA          Timestamp\\ntest   microk8s-localhost  microk8s/localhost  3.4.3    unsupported  02:16:13Z\\n\\nApp               Version                  Status   Scale  Charm             Channel      Rev  Address        Exposed  Message\\nmysql-k8s         8.0.37-0ubuntu0.22.04.3  active       1  mysql-k8s         8.0/edge     154  10.152.183.33  no       \\nmysql-router-k8s  8.0.37-0ubuntu0.22.04.3  waiting      3  mysql-router-k8s  8.0/edge       0  10.152.183.86  no       waiting for units to settle down\\nmysql-test-app    0.0.2                    active       1  mysql-test-app    latest/edge   46  10.152.183.53  no       Last written value=27572\\n\\nUnit                 Workload  Agent  Address      Ports  Message\\nmysql-k8s/0*         active    idle   10.1.123.13         Primary\\nmysql-router-k8s/0   active    idle   10.1.123.8          Router 8.0.37 running (restart pending); Charmed operator 1.2+156da2d\\nmysql-router-k8s/1   active    idle   10.1.123.9          Router 8.0.37 running (restart pending); Charmed operator 1.2+156da2d\\nmysql-router-k8s/2*  blocked   idle   10.1.123.14         Upgrade incompatible. Rollback to previous revision with `juju refresh`\\nmysql-test-app/0*    active    idle   10.1.123.11         Last written value=27572\\n'\n +  where 'Model  Controller          Cloud/Region        Version  SLA          Timestamp\\ntest   microk8s-localhost  microk8s/localhost  3.4.3    unsupported  02:16:13Z\\n\\nApp               Version                  Status   Scale  Charm             Channel      Rev  Address        Exposed  Message\\nmysql-k8s         8.0.37-0ubuntu0.22.04.3  active       1  mysql-k8s         8.0/edge     154  10.152.183.33  no       \\nmysql-router-k8s  8.0.37-0ubuntu0.22.04.3  waiting      3  mysql-router-k8s  8.0/edge       0  10.152.183.86  no       waiting for units to settle down\\nmysql-test-app    0.0.2                    active       1  mysql-test-app    latest/edge   46  10.152.183.53  no       Last written value=27572\\n\\nUnit                 Workload  Agent  Address      Ports  Message\\nmysql-k8s/0*         active    idle   10.1.123.13         Primary\\nmysql-router-k8s/0   active    idle   10.1.123.8          Router 8.0.37 running (restart pending); Charmed operator 1.2+156da2d\\nmysql-router-k8s/1   active    idle   10.1.123.9          Router 8.0.37 running (restart pending); Charmed operator 1.2+156da2d\\nmysql-router-k8s/2*  blocked   idle   10.1.123.14         Upgrade incompatible. Rollback to previous revision with `juju refresh`\\nmysql-test-app/0*    active    idle   10.1.123.11         Last written value=27572\\n' = get_juju_status('test')\n +    where 'test' = <juju.model.Model object at 0x7f3d158ff190>.name\n +      where <juju.model.Model object at 0x7f3d158ff190> = <pytest_operator.plugin.OpsTest object at 0x7f3d15dae170>.model","time":{"start":1719886218796,"stop":1719886573973,"duration":355177}},{"uid":"51e4bafd1c9535c5","reportUrl":"../135//#testresult/51e4bafd1c9535c5","status":"passed","time":{"start":1719800338095,"stop":1719800526000,"duration":187905}},{"uid":"119f0860b801ad90","reportUrl":"../134//#testresult/119f0860b801ad90","status":"passed","time":{"start":1719713744540,"stop":1719713930208,"duration":185668}},{"uid":"32398ca4496907eb","reportUrl":"../133//#testresult/32398ca4496907eb","status":"passed","time":{"start":1719626897397,"stop":1719627081515,"duration":184118}},{"uid":"da7726724169a9fa","reportUrl":"../131//#testresult/da7726724169a9fa","status":"passed","time":{"start":1719540859002,"stop":1719541046536,"duration":187534}},{"uid":"9536034b4033d460","reportUrl":"../130//#testresult/9536034b4033d460","status":"unknown","time":{}},{"uid":"bf65725cc4af093b","reportUrl":"../128//#testresult/bf65725cc4af093b","status":"passed","time":{"start":1719367722863,"stop":1719367908750,"duration":185887}},{"uid":"54e00efc9bff870a","reportUrl":"../126//#testresult/54e00efc9bff870a","status":"passed","time":{"start":1719281537333,"stop":1719281726800,"duration":189467}},{"uid":"2452c6b86862ac92","reportUrl":"../123//#testresult/2452c6b86862ac92","status":"passed","time":{"start":1719195042196,"stop":1719195228196,"duration":186000}},{"uid":"499835c7efca0d2d","reportUrl":"../122//#testresult/499835c7efca0d2d","status":"passed","time":{"start":1719108831319,"stop":1719109019926,"duration":188607}},{"uid":"81c80f8fb3ac893d","reportUrl":"../121//#testresult/81c80f8fb3ac893d","status":"passed","time":{"start":1719021977095,"stop":1719022165286,"duration":188191}},{"uid":"f2dc4418b5ec40b9","reportUrl":"../119//#testresult/f2dc4418b5ec40b9","status":"passed","time":{"start":1718935697103,"stop":1718935889740,"duration":192637}},{"uid":"ca9c7ecd61b22ac3","reportUrl":"../117//#testresult/ca9c7ecd61b22ac3","status":"passed","time":{"start":1718849254207,"stop":1718849440948,"duration":186741}},{"uid":"cdb21ee19770a95e","reportUrl":"../115//#testresult/cdb21ee19770a95e","status":"passed","time":{"start":1718763017067,"stop":1718763212267,"duration":195200}},{"uid":"a678eba400d434c8","reportUrl":"../112//#testresult/a678eba400d434c8","status":"passed","time":{"start":1718676617527,"stop":1718676804112,"duration":186585}},{"uid":"2b13b11316ca200c","reportUrl":"../111//#testresult/2b13b11316ca200c","status":"passed","time":{"start":1718590377596,"stop":1718590567399,"duration":189803}},{"uid":"8dbffc92978b26fc","reportUrl":"../110//#testresult/8dbffc92978b26fc","status":"passed","time":{"start":1718504086218,"stop":1718504275757,"duration":189539}},{"uid":"545f2e422da1fd80","reportUrl":"../109//#testresult/545f2e422da1fd80","status":"passed","time":{"start":1718417297459,"stop":1718417486810,"duration":189351}}]},"tags":["asyncio","abort_on_fail","group(1)"]},"source":"a00391c64319c260.json","parameterValues":[]}